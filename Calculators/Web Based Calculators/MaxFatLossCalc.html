<html lang="en">
<head>
<style>
form {
}

form div + div {
  margin-top: 1em;
}

label {
  /* To make sure that all labels have the same size and are properly aligned */
  display: inline-block;
  width: 120px;
  text-align: right;
}

input, textarea {
  /* To make sure that all text fields have the same font settings
     By default, textareas have a monospace font */
  font: 1em sans-serif;

  /* To give the same size to all text fields */
  width: 300px;
  box-sizing: border-box;

  /* To harmonize the look & feel of text field border */
  border: 1px solid #999;
}

input:focus, textarea:focus {
  /* To give a little highlight on active elements */
  border-color: #000;
}

textarea {
  /* To properly align multiline text fields with their labels */
  vertical-align: top;

  /* To give enough room to type some text */
  height: 5em;
}

.button {
  /* To position the buttons to the same position of the text fields */
  padding-left: 20px; /* same size as the label elements */
}

button {
  /* This extra margin represent roughly the same space as the space
     between the labels and their text fields */
  margin-left: .5em;
}
</style>
<meta charset="utf-8">
<script type="text/javascript">

	// Set up the paragraphs for the calculated results
	function write_results(){
		// Grab the elements that the user filled into variables
		var currentNumbers_parra = document.getElementById('results');
		var maintMacrosCurrent_parra = document.getElementById('DietaryMacrosMaintain');
		var loseMacrosCurrent_parra = document.getElementById('DietaryMacrosLose');
		var gainMacrosCurrent_parra = document.getElementById('DietaryMacrosGain');
		var currentWeightLbs = parseFloat(document.getElementById('weight').value);
		var userAge = parseFloat(document.getElementById('age').value);
		var heightInches = parseFloat(document.getElementById('height').value);
		var neckInches = parseFloat(document.getElementById('neck').value);
		var waistInches = parseFloat(document.getElementById('waist').value);
		var hipsInches = parseFloat(document.getElementById('hips').value);
		// Units conversions
		var startingWeightKG = currentWeightLbs/2.2;
		var heightCM = heightInches * 2.54;
		// Do the maths
		// Calculate BMR based The Harris-Benedict Formula
		var bmrMale = 88.362+(13.397*startingWeightKG)+(4.799*heightCM)-(5.677*userAge);
		var bmrFemale = 447.593 + (9.247*startingWeightKG)+(3.098*heightCM)-(4.330*userAge);
		// Initialize variables selected by activity level on the form
		var TDEEMale = 0.0;
		var TDEEFemale = 0.0;
		var proteinNeed = 2.2;	// Ted Naiman's macros use 1g per kb or 2.2g per lb
		if ( document.KetoCalc.actLevel[0].checked )
		{
			TDEEMale = bmrMale * 1.2;
			TDEEFemale = bmrFemale * 1.2;
			proteinNeed = 0.69;
		}
		if ( document.KetoCalc.actLevel[1].checked )
		{
			TDEEMale = bmrMale * 1.375;
			TDEEFemale = bmrFemale * 1.375;
			proteinNeed = 0.80;
		}
		if ( document.KetoCalc.actLevel[2].checked )
		{
			TDEEMale = bmrMale * 1.55;
			TDEEFemale = bmrFemale * 1.55;
			proteinNeed = 0.90;
		}
		if ( document.KetoCalc.actLevel[3].checked )
		{
			TDEEMale = bmrMale * 1.725;
			TDEEFemale = bmrFemale * 1.725;
			proteinNeed = 1.00;
		}
		if ( document.KetoCalc.actLevel[4].checked )
		{
			TDEEMale = bmrMale * 1.9;
			TDEEFemale = bmrFemale * 1.9;
			proteinNeed = 1.2;
		}
		// Calculate the body fat percentage
		var TDEE = 0.0;
		var BMRSelected = 0.0;
		var currentBodyFatPercentCalculated = 0.0;
		if ( document.KetoCalc.gender[0].checked )	// males
		{
			TDEE = TDEEMale;
			BMRSelected = bmrMale;
			currentBodyFatPercentCalculated = ((86.01*(Math.log10(waistInches-neckInches)))-(70.041*(Math.log10(heightInches)))+37.76);
		}
		else		// females
		{
			TDEE = TDEEFemale;
			BMRSelected = bmrFemale;
			currentBodyFatPercentCalculated = ((163.205*(Math.log10(hipsInches + waistInches - neckInches)))-(97.684*(Math.log10(heightInches)))-78.387);
		}
		// Calculate the body fat in lbs, goal weight, and the lean body mass
		var currentBodyFatLbs = (currentBodyFatPercentCalculated/100.0) * currentWeightLbs;
		var currentLBMLbs = currentWeightLbs - currentBodyFatLbs;
		// Form the output string for the results
		currentNumbers_parra.innerHTML = "Current Weight: ";
		currentNumbers_parra.innerHTML += currentWeightLbs + " lbs, " + startingWeightKG.toFixed(1) + " kg<br/>";
		currentNumbers_parra.innerHTML += "Current Body Fat</a>: " + currentBodyFatPercentCalculated.toFixed(1);
		currentNumbers_parra.innerHTML += "%, ";
		currentNumbers_parra.innerHTML += currentBodyFatLbs.toFixed(1);
		currentNumbers_parra.innerHTML += " lbs<br/>";
		currentNumbers_parra.innerHTML += "Lean Body Mass (LBM): " + currentLBMLbs.toFixed(1) + " lbs, " + (currentLBMLbs/2.2).toFixed(1) + "kg.<br/>";
		currentNumbers_parra.innerHTML += "Basal Metabolic Rate (BMR): " + Math.round(BMRSelected) + " cal/day.<br/>";
		currentNumbers_parra.innerHTML += "Total Daily Energy Expenditure (TDEE): " + Math.round(TDEE) + " cal/day.<br/>";
		var proteinGramsConstant = currentWeightLbs;
		var proteinCalsConstant = proteinGramsConstant * 4.0;
		var carbsGramsConstant = 30.0;
		var carbsCalsConstant = carbsGramsConstant * 4.0;
		var fatMaintainGrams = proteinGramsConstant - carbsGramsConstant; 
		var fatMaintainCals = fatMaintainGrams * 9.0;
		var totalCals = proteinCalsConstant + fatMaintainCals + carbsCalsConstant;
		maintMacrosCurrent_parra.innerHTML = "Protein (minimum): " + proteinGramsConstant.toFixed(1) + " grams, " + proteinCalsConstant.toFixed(1) + " calories, " + (100.0 * proteinCalsConstant / totalCals).toFixed(1) + "% of calories.<br/>";
		maintMacrosCurrent_parra.innerHTML += "Net Carbs (maximum): 30 grams, 120 calories, " + (12000.00/totalCals).toFixed(1) + "% of calories.<br/>";
		maintMacrosCurrent_parra.innerHTML += "Fat (maximum): " + fatMaintainGrams.toFixed(1) + " grams, " + fatMaintainCals.toFixed(1) + " calories, " + (100.0 * fatMaintainCals/totalCals).toFixed(1) + "% of calories.<br/>";
		maintMacrosCurrent_parra.innerHTML += "Total calories: " + Math.round(totalCals) + " calories.<br/>";
		if (TDEE > totalCals)
		{
			maintMacrosCurrent_parra.innerHTML += "Your TDEE is more than your caloric intake by ";
			maintMacrosCurrent_parra.innerHTML += Math.round(TDEE - totalCals);
			maintMacrosCurrent_parra.innerHTML += " calories.<br/>";
			maintMacrosCurrent_parra.innerHTML += "This will lead to a loss of ";
			maintMacrosCurrent_parra.innerHTML += ((TDEE - totalCals)/3500.0).toFixed(2);
			maintMacrosCurrent_parra.innerHTML += " lbs per day.<br/>";
		}
		else if (TDEE < totalCals)
		{
			maintMacrosCurrent_parra.innerHTML += "Your TDEE is less than your caloric intake by ";
			maintMacrosCurrent_parra.innerHTML += Math.round(TDEE - totalCals);
			maintMacrosCurrent_parra.innerHTML += " calories.<br/>";
			maintMacrosCurrent_parra.innerHTML += "This will lead to a gain of ";
			maintMacrosCurrent_parra.innerHTML += ((totalCals - TDEE)/3500.0).toFixed(2);
			maintMacrosCurrent_parra.innerHTML += " lbs per day.<br/>";
		}
		// Macros to Lose Weight
		// Fat calculation is complex
		var fatCaloriesAvailableFromBodyFat = 24.0 * currentBodyFatLbs;
		var fatGramsAvailableFromBodyFat = fatCaloriesAvailableFromBodyFat / 9.0;
		var fatGramsNaimanCalculation = (proteinGramsConstant / 2.0) - carbsGramsConstant;
		var fatGramsFromTDEE = (TDEE - carbsCalsConstant - proteinCalsConstant) / 9.0;
		var fatLoseGramsSelected = 0.0;
		var fatLoseCals = 0.0;
		if ((fatGramsAvailableFromBodyFat < fatGramsNaimanCalculation) && (fatGramsAvailableFromBodyFat < fatGramsFromTDEE))
		{
			fatLoseGramsSelected = fatGramsFromTDEE - fatGramsAvailableFromBodyFat;
			loseMacrosCurrent_parra.innerHTML = "Your body fat is limiting fat loss. Your fat macro is your fat from TDEE minus body fat (1).<br/>";
			}
		else if ((fatGramsAvailableFromBodyFat < fatGramsNaimanCalculation) && (fatGramsAvailableFromBodyFat > fatGramsFromTDEE) && (fatGramsAvailableFromBodyFat < fatGramsNaimanCalculation))
		{
			fatLoseGramsSelected = fatGramsFromTDEE;
				loseMacrosCurrent_parra.innerHTML = "Your TDEE is limiting fat loss.<br/>";
		}
		else if (fatGramsFromTDEE < fatGramsNaimanCalculation)
		{
			fatLoseGramsSelected = fatGramsFromTDEE;
			loseMacrosCurrent_parra.innerHTML = "Your TDEE is limiting fat loss.<br/>";
		}
		else if (fatGramsAvailableFromBodyFat > fatGramsFromTDEE - fatGramsNaimanCalculation)
		{
			fatLoseGramsSelected = fatGramsNaimanCalculation;
			loseMacrosCurrent_parra.innerHTML = "Your body has more fat available than the Naiman P=2xNPE number. Using Naiman number for fat loss.<br/>";
		}
		else
		{
			fatLoseGramsSelected = fatGramsFromTDEE - fatGramsAvailableFromBodyFat;
			loseMacrosCurrent_parra.innerHTML = "Your body fat is limiting fat loss. Your fat macro is your fat from TDEE minus body fat (2).<br/>";
		}
		fatLoseCals = fatLoseGramsSelected * 9.0; 
		var loseTotalCals = 0.0;
		loseTotalCals = proteinCalsConstant + carbsCalsConstant + fatLoseCals;
		loseMacrosCurrent_parra.innerHTML += "You have a maximum of ";
		loseMacrosCurrent_parra.innerHTML += fatGramsAvailableFromBodyFat.toFixed(1);
		loseMacrosCurrent_parra.innerHTML += " grams of fat (" + (9.0*fatGramsAvailableFromBodyFat).toFixed(1) +  " calories) you can take from your body fat per day.<br/>";
		loseMacrosCurrent_parra.innerHTML += "Maintaining your weight at your TDEE requires ";
		loseMacrosCurrent_parra.innerHTML += fatGramsFromTDEE.toFixed(1);
		loseMacrosCurrent_parra.innerHTML += " grams of fat.<br/>";
		loseMacrosCurrent_parra.innerHTML += "Your P:2NPE number is ";
		loseMacrosCurrent_parra.innerHTML += fatGramsNaimanCalculation.toFixed(1);
		loseMacrosCurrent_parra.innerHTML += " grams of fat.<br/>";
		loseMacrosCurrent_parra.innerHTML += "Protein (minimum): " + proteinGramsConstant.toFixed(1) + " grams, " + proteinCalsConstant.toFixed(1) + " calories, " + (100.0 * proteinCalsConstant/loseTotalCals).toFixed(1) + "% of calories.<br/>";
		loseMacrosCurrent_parra.innerHTML += "Net Carbs (maximum): 30 grams, 120 calories, " + (100.0 * 120.0/loseTotalCals).toFixed(1) + "% of calories.<br/>";
		// determine minimum number of calories that can come from fat
		loseMacrosCurrent_parra.innerHTML += "Fat target: " + fatLoseGramsSelected.toFixed(1) + " grams, " + fatLoseCals.toFixed(1) + " calories, " + (100.0 * fatLoseCals/loseTotalCals).toFixed(1) + "% of calories.<br/>";
		loseMacrosCurrent_parra.innerHTML += "Total calories: " + Math.round(loseTotalCals) + " calories.<br/>";
		if (TDEE > loseTotalCals)
		{
			loseMacrosCurrent_parra.innerHTML += "Your TDEE is more than your caloric intake by ";
			loseMacrosCurrent_parra.innerHTML += Math.round(TDEE - loseTotalCals);
			loseMacrosCurrent_parra.innerHTML += " calories.<br/>";
			loseMacrosCurrent_parra.innerHTML += "This will lead to a loss of ";
			loseMacrosCurrent_parra.innerHTML += ((TDEE - loseTotalCals)/3500.0).toFixed(2);
			loseMacrosCurrent_parra.innerHTML += " lbs per day, or " + (30.9*(TDEE - loseTotalCals)/3500.0).toFixed(1) + " lbs per month.<br/>";
		}
		else if (TDEE < loseTotalCals)
		{
			loseMacrosCurrent_parra.innerHTML += "Your TDEE is less than your caloric intake by ";
			loseMacrosCurrent_parra.innerHTML += Math.round(TDEE - loseTotalCals);
			loseMacrosCurrent_parra.innerHTML += " calories.<br/>";
			loseMacrosCurrent_parra.innerHTML += "This will lead to a gain of ";
			loseMacrosCurrent_parra.innerHTML += ((loseTotalCals - TDEE)/3500.0).toFixed(2);
			loseMacrosCurrent_parra.innerHTML += " lbs per day.<br/>";
		}
		// Macros to Gain Weight
		var fatGainGrams = (proteinGramsConstant * 2.0) - carbsGramsConstant; 
		var fatGainCals = fatGainGrams * 9.0;
		var gainTotalCals = 0.0;
		gainTotalCals = proteinCalsConstant + fatGainCals + carbsCalsConstant;
		gainMacrosCurrent_parra.innerHTML = "Protein (minimum): " + proteinGramsConstant.toFixed(1) + " grams, " + proteinCalsConstant.toFixed(1) + " calories, " + (100.0 * proteinCalsConstant / gainTotalCals).toFixed(1) + "% of calories.<br/>";
		gainMacrosCurrent_parra.innerHTML += "Net Carbs (maximum): 30 grams, 120 calories, " + (12000.00/gainTotalCals).toFixed(1) + "% of calories.<br/>";
		gainMacrosCurrent_parra.innerHTML += "Fat (maximum): " + fatGainGrams.toFixed(1) + " grams, " + fatGainCals.toFixed(1) + " calories, " + (100.0 * fatGainCals/gainTotalCals).toFixed(1) + "% of calories.<br/>";
		gainMacrosCurrent_parra.innerHTML += "Total calories: " + Math.round(gainTotalCals) + " calories.<br/>";
		if (TDEE > gainTotalCals)
		{
			gainMacrosCurrent_parra.innerHTML += "Your TDEE is more than your caloric intake by ";
			gainMacrosCurrent_parra.innerHTML += Math.round(TDEE - gainTotalCals);
			gainMacrosCurrent_parra.innerHTML += " calories.<br/>";
			gainMacrosCurrent_parra.innerHTML += "This will lead to a loss of ";
			gainMacrosCurrent_parra.innerHTML += ((TDEE - gainTotalCals)/3500.0).toFixed(2);
			gainMacrosCurrent_parra.innerHTML += " lbs per day.<br/>";
		}
		else if (TDEE < gainTotalCals)
		{
			gainMacrosCurrent_parra.innerHTML += "Your caloric intake is more than your by TDEE by ";
			gainMacrosCurrent_parra.innerHTML += Math.round(gainTotalCals - TDEE);
			gainMacrosCurrent_parra.innerHTML += " calories.<br/>";
			gainMacrosCurrent_parra.innerHTML += "This will lead to a gain of ";
			gainMacrosCurrent_parra.innerHTML += ((gainTotalCals - TDEE)/3500.0).toFixed(2);
			gainMacrosCurrent_parra.innerHTML += " lbs per day.<br/>";
		}
		// Calculate the PSMF macros
		var maxFatMobilizationCals = currentBodyFatLbs * 24.0;
		var netFatCals = TDEE - proteinCalsConstant - maxFatMobilizationCals - 120.0;
		if (netFatCals < 0)	// Don't allow this number to go below 0
			netFatCals = 0;
	}
	</script>
</head>
<body>
<h1>Macros Calculator</h1>
<b>This calculator only works in Chrome or Firefox (not in IE).</b><p/>
<b>Privacy Information</b>: This calculator runs locally on your computer. None of your personal data is stored on our server.
<h2>Enter Your Numbers</h2>
<form Name="KetoCalc">
    <div>
        <label for="Age">Age:</label>
        <input type="text" id="age" name="user_age" value="58" maxlength="6" autofocus>
    </div>
	<div>
		<input type="radio" name="gender" value="male" checked> Male<br>
		<input type="radio" name="gender" value="female"> Female
    </div>
	<div>
        <label for="Height">Height :</label>
        <input type="text" id="height" name="user_height" value="70.5"> inches (bare feet)
    </div>
    <div>
        <label for="Weight">Weight :</label>
        <input type="text" id="weight" name="user_weight" value="162.4"> lbs (without clothes)
    </div>
    <div>
        <label for="Neck">Neck :</label>
        <input type="text" id="neck" name="user_neck" value="14.5"> inches (smallest circumference)
    </div>
    <div>
        <label for="Waist">Waist :</label>
        <input type="text" id="waist" name="user_waist" value="32.0"> inches (at your belly button)
    </div>
    <div>
        <label for="Hips">Hips (females) :</label>
        <input type="text" id="hips" name="user_hips" value="34"> inches
    </div>
	<div>
	Select your <a target=\"_blank\" href="https://ketogains.com/ketogains-calculator/" >Activity Level</a><br/>
		<input type="radio" name="actLevel" value="Sedentary"> Sedentary<br>
		<input type="radio" name="actLevel" value="LightlyActive" checked> Lightly Active<br>
		<input type="radio" name="actLevel" value="ModeratelyActive"> Moderately Active<br>
		<input type="radio" name="actLevel" value="VeryActive"> Very Active<br>
		<input type="radio" name="actLevel" value="ExtremelyActive"> Extremely Active
    </div>
<div class="button">
  <input type="button" value="Calculate" onclick="write_results();"/>
</div>
</form>
<i>Scroll down for results after pressing Calculate</i><p/>
<hr/>
<h2>Your Current Numbers</h2>
<p id="results"></p>
<h2>Dietary Macro Levels</h2>
<ul>
<li>PE = Protein Energy (in grams)</li>
<li>NPE = Non-Protein Energy (Fat plus Carbs - in grams)</li>
</ul>
<h3>Maintenance Macro Levels (NPE=PE)</h3>
<p id="DietaryMacrosMaintain"></p>
<h3>Macro Levels to Lose Body Weight (PE = 2NPE)</h3>
<p id="DietaryMacrosLose"></p>
<h3>Macro Levels to Gain Body Weight (NPE = 2PE)</h3>
<p id="DietaryMacrosGain"></p>
<h2>Notes</h2>
This diet preserves the most lean body mass possible and provides satiety.
If you go below these numbers you risk lowering your metabolism and you may not be able to lose body fat any faster.
It is better to be slightly above these macros than below the macros.
This amount of fat in your diet frees up the maximum amount of fat from your body because it does not allow your metabolism to drop.</li>
It could be helpful to frequently rerun these numbers based on updated measurements as you progress.
<h2>References</h2>
<ul>
<li><a target="_blank" href="http://www.dtic.mil/dtic/tr/fulltext/u2/a370158.pdf">U. S. Navy Body Fat Calculator</a></li>
<li><a target="_blank" href="http://lowcarbstudies.com/blog/2018/03/29/determine-your-ideal-body-weight/">Determine Your Ideal Body Weight</a></li>
<li><a target="_blank" href="https://en.wikipedia.org/wiki/Lean_body_mass">Lean Body Mass (Wikipedia)</a></li>
<li><a target="_blank" href="https://www.ncbi.nlm.nih.gov/pubmed/6741850">The Harris Benedict (BMR) equation reevaluated: resting energy requirements and the body cell mass</a></li>
<li><a target="_blank" href="https://tdeecalculator.net/">Total Daily Energy Expenditure</a></li>
<li><a target="_blank" href="http://www.superskinnyme.com/calculate-tdee.html">TDEE Formula by activity level</a>.</li>
<li><a target="_blank" href="http://lowcarbstudies.com/blog/2018/03/29/hypophagia-how-much-fat-can-i-lose-in-a-day/">How Much Fat Can I Lose in a Day?</a></li>
<li><a target="_blank" href="https://burnfatnotsugar.com/">Ted Naiman's Burn Fat Not Sugar macros</a></li>
<li><a target="_blank" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1646394/">Multidisciplinary treatment of obesity with a protein-sparing modified fast: results in 668 outpatients.</a></li>
<li><a target="_blank" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2804964/">Protein plus Insulin builds muscle.</a></li>
</ul>
<h3>Ted Naiman's Burn Sugar Not Fat Diet 2.0 infographic</h3>
<img src = "https://burnfatnotsugar.com/Diet20/image14@2x.PNG"></img>
<h2>Disclaimer</h2>
Use this information at your own risk and with the advice of your medical professional. 
We are not doctors nor do we pretend to be one on the Internet.
We do not take responsibility for errors in these calculations.
We do not guarantee that these numbers will work for people at the extremes of the ranges.
If you discover an error in calculation, please let us know through email: keto at land-boards dot com.
</body>
</html>
