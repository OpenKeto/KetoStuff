Bootstrapper.bindDOMParsed(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;var consent=Bootstrapper.npg.utils.Consent;if(consent.allow(consent.TARGETING)){var images=document.images;var sendNielson=true;if(images.length>-1){var i=0;for(i;i<images.length;i++)if(images[i].src&&images[i].src.indexOf("secure-us.imrworldwide.com")>-1)sendNielson=false}if(sendNielson)(function(){var d=new Image(1,1);d.onerror=d.onload=function(){d.onerror=d.onload=null};
d.src=["//secure-us.imrworldwide.com/cgi-bin/m?ci\x3dus-504674h\x26cg\x3d0\x26cc\x3d1\x26si\x3d",escape(window.location.href),"\x26rp\x3d",escape(document.referrer),"\x26ts\x3dcompact\x26rnd\x3d",(new Date).getTime()].join("")})()}},2463291,136505);
Bootstrapper.bindDOMParsed(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;var consent=Bootstrapper.npg.utils.Consent;if(consent.allow(consent.TARGETING)){var c_id="14617931";var _comscore=window._comscore=_comscore||[];_comscore.push({c1:"2",c2:c_id});var protocol=document.location.protocol=="https:"?"https://sb":"http://b";Bootstrapper.insertScript(protocol+".scorecardresearch.com/beacon.js")}},2463378,541797);
Bootstrapper.bindDOMLoaded(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;function splitKeys(targeting){var i;var j;var value=[];var valuesArray=[];var key;var prevKey="";var keyValue;var keyValuesArray=[];var splittedTargeting=targeting.split(";");for(i=0;i<splittedTargeting.length;++i){if(key!==undefined)prevKey=key;keyValue=splittedTargeting[i].split("\x3d");key=keyValue[0];if(key!==prevKey){if(prevKey.length>0&&valuesArray.length>0)keyValuesArray.push([prevKey,
valuesArray]);valuesArray=[]}if(keyValue.length===2&&keyValue[0]!==""&&keyValue[1]!==""){value=keyValue[1].split(",");for(j=0;j<value.length;++j)valuesArray.push(value[j])}}if(key.length>0&&valuesArray.length>0)keyValuesArray.push([key,valuesArray]);return keyValuesArray}function splitSizes(sizes){var i;var tmp;var height;var width;var sizeArray=[];var splittedSizes;if(sizes!==null){if(sizes.indexOf("|")!==-1)splittedSizes=sizes.split("|");else splittedSizes=sizes.split(",");for(i=0;i<splittedSizes.length;++i){tmp=
splittedSizes[i].split("x");width=parseInt(tmp[0],10);height=parseInt(tmp[1],10);if(tmp.length===2&&!isNaN(width)&&!isNaN(height)&&width>=0&&height>=0)sizeArray.push([width,height])}}return sizeArray}function hasClass(element,className){var i;var len;var elementClasses=element.className.split(/\s+/);for(i=0,len=elementClasses.length;i<len;++i)if(elementClasses[i]===className)return true;return false}function getAdContainers(){if(typeof document.getElementsByClassName==="function")return document.getElementsByClassName("div-gpt-ad");
else{var i;var containerDivs=[];var elements=document.getElementsByTagName("div");for(i=0;elements[i];++i)if(hasClass(elements[i],"div-gpt-ad"))containerDivs.push(elements[i]);return containerDivs}}function debounce(fn,threshold){var last=null;var timer=null;return function(){var context=this;var now=+new Date;var args=arguments;if(last&&now<last+threshold){clearTimeout(timer);timer=setTimeout(function(){last=now;fn.apply(context,args)},threshold)}else{last=now;fn.apply(context,args)}}}function addResizeEvent(fn){if(window.addEventListener)window.addEventListener("resize",
fn,false);else window.attachEvent("resize",fn)}function addScrollEvent(fn){if(window.addEventListener)window.addEventListener("scroll",fn,false);else window.attachEvent("onscroll",fn)}function removeScrollEvent(fn){if(window.removeEventListener)window.removeEventListener("scroll",fn,false);else window.detachEvent("scroll",fn)}(function(win,documentElement,Krux){var utils=Bootstrapper.npg.utils;var consent=utils.Consent;Krux=Krux||{};if(utils.Request.get("hide_ads")==="true")return;var debug=utils.Request.get("debug_collections")===
"true";Bootstrapper.loadScriptCallback("//www.googletagservices.com/tag/js/gpt.js",function(){var krux=Krux.dfppKeyValues&&consent.allow(consent.TARGETING)?";"+Krux.dfppKeyValues:"";var adSlotIds=[];var adSlots=[];var adContainers=getAdContainers();var adContainer;var billboardSlot;var displayAdSlots=function(slots,predicate){var n=slots.length;var adsToRefresh=[];while(n--)if(predicate(slots[n],n)){adsToRefresh.push(slots[n].slot);slots.splice(n,1)}if(adsToRefresh.length)googletag.pubads().refresh(adsToRefresh);
return slots};var getTargeting=function(container){var test=Bootstrapper.npg.utils.Request.get("test");var ads=test&&test==="ads"?";adtyp\x3dtest":"";var targeting=container.getAttribute("data-gpt-targeting");if(ads&&targeting.indexOf(ads)===-1)targeting+=ads;return targeting+krux};var isBrandedArticle=function(pathname){var paths=["d42473-018-00006-2","d42473-018-00009-z","d42473-018-00004-4","d42473-018-00014-2"];for(var i=0;paths[i];++i)if(pathname.indexOf("/"+paths[i])!==-1)return true;return false};
var unitPath=function(path){if(isBrandedArticle(win.location.pathname))return"/270604982/Nature/brandedcontent";if(debug)return path.replace("/nature.com","");return path};win.googletag=win.googletag||{};win.googletag.cmd=win.googletag.cmd||[];for(var i=0;adContainers[i];++i){adContainer=adContainers[i];if(adContainer.className.indexOf("leaderboard")!==-1&&window.innerWidth<729);else adSlots.push({divId:adContainer.getAttribute("id"),adUnitPath:unitPath(adContainer.getAttribute("data-gpt-unitpath")),
sizeArray:splitSizes(adContainer.getAttribute("data-gpt-sizes")),targeting:splitKeys(getTargeting(adContainer)),isOutOfPage:hasClass(adContainer,"out-of-page"),forceLoadOnInit:false,refreshed:false})}googletag.cmd.push(function(){googletag.pubads().setRequestNonPersonalizedAds(consent.allow(consent.TARGETING)?0:1);googletag.pubads().disableInitialLoad();googletag.enableServices();googletag.pubads().addEventListener("slotRenderEnded",function(event){var slotId=event.slot.j?event.slot.j.m:event.slot.l?
event.slot.l.m:null;var slot;console.log(slotId,event.isEmpty);if(slotId==="div-gpt-ad-billboard-2"&&event.isEmpty===false){console.log(slotId,event.isEmpty);slot=document.getElementById(slotId);slot.parentNode.parentNode.classList.add("pb40");slot.parentNode.parentNode.classList.remove("pb20");slot.parentNode.parentNode.classList.remove("hide")}if(slotId&&event.isEmpty){slot=document.getElementById(slotId);slot.parentNode.parentNode.classList.remove("pb20");slot.parentNode.classList.remove("ad-with-label")}})});
googletag.cmd.push(function(){for(var i=0;adSlots[i];++i)try{if(adSlots[i].isOutOfPage)adSlots[i].slot=googletag.defineOutOfPageSlot(adSlots[i].adUnitPath,adSlots[i].divId).addService(googletag.pubads());else adSlots[i].slot=googletag.defineSlot(adSlots[i].adUnitPath,adSlots[i].sizeArray,adSlots[i].divId).addService(googletag.pubads());for(var j=0,len=adSlots[i].targeting.length;j<len;++j)if(adSlots[i].targeting[j].length===2&&adSlots[i].targeting[j][0]!==""&&adSlots[i].targeting[j][1]!==""){if(adSlots[i].targeting[j][0]===
"pos")if(adSlots[i].targeting[j][1][0]==="billboard"){billboardSlot=adSlots[i].slot;var mapping=googletag.sizeMapping().addSize([970,250],[3,3]).addSize([770,100],[4,4]).addSize([0,0],[5,5]).build();billboardSlot.defineSizeMapping(mapping);billboardSlot.setCollapseEmptyDiv(true,true)}adSlots[i].slot.setTargeting(adSlots[i].targeting[j][0],adSlots[i].targeting[j][1])}}catch(e){console.log("failed to create slot for",adSlots[i])}});googletag.cmd.push(function(){for(var i=0;adSlots[i];++i)googletag.display(adSlots[i].divId)});
var loadVisibleAds=function(adSlots){var height=Math.max(documentElement.clientHeight,win.innerHeight||0);return displayAdSlots(adSlots,function(slot){if(slot.isOutOfPage||slot.forceLoadOnInit)return true;var node=document.getElementById(slot.divId);var rect=node.getBoundingClientRect();var top=rect.top-300;return height>top})};googletag.cmd.push(function(){adSlots=loadVisibleAds(adSlots)});var desktop=window.innerWidth>969;var tablet=window.innerWidth>769&&!desktop;var mobile=window.innerWidth<770;
var resizeListener=debounce(function(){var currentWidth=window.innerWidth;if(currentWidth>=970&&!desktop){desktop=true;tablet=false;mobile=false;googletag.cmd.push(function(){googletag.pubads().refresh([billboardSlot])})}else if(currentWidth<770&&!mobile){desktop=false;tablet=false;mobile=true;googletag.cmd.push(function(){googletag.pubads().refresh([billboardSlot])})}else if(currentWidth<970&&currentWidth>769&&!tablet){desktop=false;tablet=true;mobile=false;googletag.cmd.push(function(){googletag.pubads().refresh([billboardSlot])})}},
250);var scrollListener=debounce(function(){googletag.cmd.push(function(){adSlots=loadVisibleAds(adSlots);if(!adSlots.length)removeScrollEvent(scrollListener)})},250);addResizeEvent(resizeListener);addScrollEvent(scrollListener)})})(window,document.documentElement,window.Krux)},2495575,363632);
Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;(function(){var d=document,f=d.getElementsByTagName("script")[0];s=d.createElement("script");s.type="text/javascript";s.async=true;s.src="//cdn.cookielaw.org/consent/792a5a21-3d99-4432-8f70-957d389bf2b9.js";f.parentNode.insertBefore(s,f)})();function OptanonWrapper(){}},2491392,517174);