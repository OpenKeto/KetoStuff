define(["require","exports","tslib","external/react","modules/clean/react/previews/pdf_viewer/text/bidi","modules/clean/react/previews/pdf_viewer/text/unicode","modules/clean/referrer_cleansing_redirect","modules/clean/react/previews/constants","modules/clean/react/previews/pdf_viewer/utils","modules/core/exception"],function(e,t,r,i,n,o,a,s,c,l){"use strict";function h(e){var t=a.get_redirect_uri(c.normalizeUrl(e)).toString();return i.createElement("a",{href:t,target:"_blank",rel:"noreferrer noopener"},e)}function p(e){var t="mailto:"+e;return i.createElement("a",{href:t},e)}function f(e){return e.split(" ").map(function(e,t,r){var i=(0===t?"":" ")+e+(t===r.length-1?"":" ");if(x.test(e))i=p(e);else if(u.test(e))try{i=h(e)}catch(e){l.reportException({err:new Error("URL parsing failed"),tags:["pdfPreviews"],severity:l.SEVERITY.NONCRITICAL})}return i})}function d(e){if("string"==typeof e.children){var t=f(e.children);return i.createElement.apply(i,["span",{}].concat(t))}return null}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),a=r.__importStar(a),l=r.__importStar(l);var u=new RegExp(s.HYPERLINK_REGEX_STRING),x=new RegExp(s.EMAIL_REGEX_STRING);t.LinkedText=d;var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={xScale:1,yScale:1},t.ref=function(e){t.textElement=e},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.textElement){var e=this.props,t=e.text,r=e.width,i=e.height,n=e.fontSize;this.setState(this.scaleText(t,r,i,n),this.props.onRender)}},t.prototype.measureText=function(e,t){return e!==this.cachedText&&(this.cachedText=e,this.cachedTextWidth=t.clientWidth,this.cachedTextHeight=t.clientHeight),{textWidth:this.cachedTextWidth,textHeight:this.cachedTextHeight}},t.prototype.scaleText=function(e,t,r,i){var n=!0;if(e.length<=1)n=!1;else if(2===e.length){var o=e.charCodeAt(0),a=e.charCodeAt(1);o>=55296&&o<=56319&&a>=56320&&a<=57343&&(n=!1)}if(n){var s=this.measureText(e,this.textElement),c=s.textWidth,l=s.textHeight;return{xScale:t/c,yScale:i?1:r/l}}return{xScale:1,yScale:1}},t.prototype.componentWillReceiveProps=function(e){var t=e.text,r=e.width,i=e.height,n=e.fontSize;this.setState(this.scaleText(t,r,i,n))},t.prototype.render=function(){var e=this.props,t=e.text,r=e.x,a=e.y,s=e.rotation,c={left:r,bottom:a,transform:"rotate("+-s+"rad) scale("+this.state.xScale+", "+this.state.yScale+")"};this.props.font&&(c.fontFamily=this.props.font.fontFamily,this.props.font.isBold&&(c.fontWeight="bold"),this.props.font.isItalic&&(c.fontStyle="italic")),this.props.fontSize&&(c.fontSize=this.props.fontSize+"px");for(var l=o.getNormalizedUnicodes(),h="",p=0;p<t.length;p++){var f=t.charAt(p);void 0!==l[f]&&(f=l[f]),f=o.reverseIfRtl(f),"\t"===f&&(f=" "),h+=f}var u=n.bidi(h,-1,!1),x=u.str,m=u.dir;return i.createElement("p",{className:"textbox",style:c,ref:this.ref,dir:m},i.createElement(d,null,x))},t})(i.PureComponent);t.TextBox=m});
//# sourceMappingURL=text_box.min.js-vflXb2gbm.map